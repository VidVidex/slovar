<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM" crossorigin="anonymous" />

    <title>Slovar</title>
  </head>

  <body class="min-vh-100 d-flex flex-column justify-content-between">
    <div id="app">
      <div class="container mt-5">
        <div class="row justify-content-center">
          <div class="col-8">
            <div class="input-group mb-3">
              <input type="text" class="form-control" autofocus v-on:keyup.enter="translate" placeholder="Išči..." v-model="query" />
              <button class="btn btn-primary" @click="translate">Išči</button>
            </div>
          </div>
        </div>

        <div class="d-flex justify-content-center mt-5" v-if="waiting">
          <div class="spinner-border" role="status">
            <span class="visually-hidden">Loading...</span>
          </div>
        </div>

        <div class="row justify-content-center">
          <div class="col-8">
            <h3 v-if="translations.dis.length > 0" class="d-flex justify-content-center mt-4">DIS slovarček</h3>
            <div class="row" v-for="translation in translations.dis">
              <div class="col d-flex justify-content-end">{{ translation.en }}</div>
              <div class="col">{{ translation.sl }}</div>
            </div>

            <h3 v-if="translations.ltfe.length > 0" class="d-flex justify-content-center mt-4">LTFE IKT slovar</h3>
            <div class="row" v-for="translation in translations.ltfe">
              <div class="col d-flex justify-content-end">{{ translation.en }}</div>
              <div class="col">{{ translation.sl }}</div>
            </div>

            <h3 v-if="translations.ijs.length > 0" class="d-flex justify-content-center mt-4">IJS slovar</h3>
            <div class="row" v-for="translation in translations.ijs">
              <div class="col d-flex justify-content-end">{{ translation.en }}</div>
              <div class="col">{{ translation.sl }}</div>
            </div>

            <h3 v-if="translations.googletrans.length > 0" class="d-flex justify-content-center mt-4">Google prevajalnik</h3>
            <div class="row" v-for="translation in translations.googletrans">
              <div class="col d-flex justify-content-end">{{ translation.en }}</div>
              <div class="col">{{ translation.sl }}</div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="container">
      <footer class="d-flex flex-wrap justify-content-between align-items-center py-3 my-4 border-top">
        <div class="col-md-4 d-flex align-items-center">
          <a href="https://github.com/VidVidex" class="mb-3 mb-md-0 text-body-secondary text-decoration-none">Vid Smole</span>
        </div>

        <ul class="nav col-md-4 justify-content-end list-unstyled d-flex">
          <li class="ms-3">
            <a class="text-body-secondary" href="https://github.com/VidVidex/slovar"><img height="32px" src="github-mark.svg"></a>
          </li>
        </ul>
      </footer>
    </div>
  </body>

  <script type="module">
    import { createApp } from "https://unpkg.com/petite-vue@0.2.2/dist/petite-vue.es.js";

    createApp({
      query: "",
      translations: {
        dis: [],
        ltfe: [],
        ijs: [],
        googletrans: [],
      },
      waiting: false,
      translate() {
        if (this.query === "") return;

        const data = { query: this.query };
        const params = {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(data),
        };

        this.waiting = true;

        for (const [key, value] of Object.entries(this.translations)) {
          this.translations[key] = [];

          const response = fetch("https://" + key + "-wndv3z5k4q-uc.a.run.app/", params)
            .then((response) => response.json())
            .then((translations) => {
              this.translations[key] = translations;
              this.waiting = false;
            });
        }
      },
    }).mount();
  </script>
</html>
